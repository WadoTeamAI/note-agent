# 🧭 note記事自動生成エージェント 要件定義書（2025年10月版）

## 1. プロジェクト概要

### 1.1 名称

**note記事自動生成エージェント（Note Agent AI）**

### 1.2 目的

「誰でも、たった数分で"SEOに強く・読まれる"note記事を生成できること」。
構成設計、本文執筆、画像生成、投稿準備までを一気通貫で自動化し、クリエイターが「発想と表現」に集中できる環境を作る。

### 1.3 背景

* AIライティングが一般化する中で、**"記事の量産"ではなく"高品質な一貫性ある発信"**が求められている。
* **note記事に特化**し、noteプラットフォームのアルゴリズム理解を踏まえた最適化を実現。
* **AIっぽいライティングの改善**：自然で人間らしい文章表現をプロンプト最適化により実現。翻訳調の表現や機械的な文体を排除し、共感性と読みやすさを重視。
* Gemini 2.5シリーズ（Pro/Flash）の高度な日本語処理能力とマルチモーダル機能により、**テキスト・画像・リサーチを統合した記事生成**が可能に。
* **2025年のAIトレンド対応**：マルチエージェント協調、RAG（Retrieval-Augmented Generation）、リアルタイムコラボレーション。

---

## 2. サービスコンセプト（＝サービスの「魂」）

| 観点          | 内容                                                                         |
| ----------- | -------------------------------------------------------------------------- |
| WHY（なぜ）     | 書く時間ではなく、**リサーチと戦略に集中できる環境**を提供するため。AIっぽくない自然な文章で、読者に響く記事を生成。 |
| WHAT（何を）    | note記事の統合自動生成エージェント。**統合リサーチ → SEO分析 → 構成作成 → 執筆 → 画像生成 → SNS展開**までを一気通貫で自動化。最新のマルチモーダルAIとRAG技術を活用。 |
| WHO（誰に）     | note運営者、ブロガー、企業の広報担当、ライター志望者、SNSマーケター、コンテンツクリエイター。                                              |
| HOW（どう実現する） | **React + TypeScript + Gemini 2.5 (Pro/Flash) + 外部API統合 + RAG**。マルチソースリサーチとマルチモーダル生成を組み合わせた次世代エージェント。 |

---

## 3. 登場人物（ユーザー定義）

| 役割              | 説明                          |
| --------------- | --------------------------- |
| 一般ユーザー          | note記事を作成したい人。テーマ・トーンなどを入力。 |
| システム（AIエージェント）  | 構成・本文・画像を自動生成し、成果物を出力。マルチエージェント協調で高度な処理を実行。      |
| note投稿者（拡張ユーザー） | 生成結果をnote上で公開し、編集・加筆を行う。    |
| 企業ユーザー（新規）    | ブランドガイドラインに沿った記事を複数人で管理・運用。    |

---

## 4. 主なユースケース

1. **キーワードからの記事生成（統合リサーチ付き）**
   　→ 例：「副業 始め方」を入力 → 統合リサーチ（Google検索＋note人気記事＋SNSトレンド） → SEO分析 → 構成案 → 本文 → 画像生成 → X告知文。

2. **YouTube動画URLからの記事生成**
   　→ 動画文字起こし→ 要約→ note記事化 → 関連トレンドリサーチ → SNS展開文生成。

3. **音声入力からの記事生成【新機能】**
   　→ スマホで録音した音声メモ → 文字起こし → 記事化。移動中・アイデア思いついた瞬間に記事化開始。

4. **テーマ・トーン指定によるブランド一貫ライティング**
   　→ tone=「フレンドリー」＋ audience=「初心者向け」などで一貫性を維持。AIっぽくない自然な文体を実現。

5. **長文記事生成（5,000〜10,000文字）+ 差し込み図解**
   　→ 複雑なテーマを体系的に解説。マルチモーダル機能で図解を自動生成し視覚的に理解しやすく。

6. **SNS連携訴求（X告知文 + スレッド展開）**
   　→ 記事公開と同時に、ターゲット別のX投稿文を5パターン生成。長文・スレッド形式にも展開。

7. **トレンド記事の高速生成**
   　→ SNSやnoteで話題のテーマをリサーチし、タイムリーな記事を自動生成。アルゴリズム最適化でリーチ最大化。

8. **複数バージョン生成（A/Bテスト対応）【新機能】**
   　→ 同じテーマで異なるアプローチの記事を3〜5パターン生成。反響を見てベストを選択。

9. **コラボレーション記事生成【新機能】**
   　→ 複数人でリアルタイム編集。役割分担（リサーチ担当、執筆担当、画像担当など）。

10. **過去記事のリライト・最適化【新機能】**
    　→ 既存記事を分析し、最新SEOトレンドに合わせて自動リライト提案。

---

## 5. 機能要件【第1回・第2回を統合 + 2025年新機能】

### 5.1 入力項目（ユーザー入力UI）

| 項目                   | 型        | 説明                | 例 / デフォルト      |
| -------------------- | -------- | ----------------- | -------------- |
| キーワード or YouTube URL or 音声ファイル | text/file     | 記事の主題入力           | 「副業 始め方」       |
| 文体（トーン）              | dropdown | 丁寧 / フレンドリー / 専門的 / カジュアル / ビジネス | 丁寧             |
| 想定読者層                | dropdown | 初心者 / 中級者 / 上級者 / 全般  | 初心者            |
| 文字数目安                | dropdown | 本文の長さ             | 2500 / 5000 / 10000 |
| 画像生成オプション            | checkbox | アイキャッチ / 差し込み図解   | アイキャッチのみ       |
| 生成バージョン数【新】            | dropdown | A/Bテスト用             | 1 / 3 / 5       |
| モデル選択【新】            | dropdown | 高速（Flash） / 高品質（Pro）             | Flash       |
| RAG有効化【新】            | checkbox | 外部知識ベース参照             | OFF       |

---

### 5.2 記事生成フロー（Buildワークフロー構成）

#### Step 0. 統合リサーチ機能【主力機能・強化版】

* **処理**: 複数の情報源から最新データを収集・分析
* **リサーチ対象**:
  * **外部検索API / Google Search API**: キーワードの検索トレンド、上位記事の分析
  * **note プラットフォーム分析**: 伸びている投稿、スキ数、閲覧数の高い記事の傾向分析
  * **SNS トレンド**: X（Twitter）、Threads、Instagramでのトレンド性、話題性の調査
  * **SEO 最新情報**: 検索ボリューム、関連キーワード、競合度の把握
  * **アルゴリズム理解**: noteのレコメンドアルゴリズムを踏まえた最適化ポイント
  * **【新】Reddit/はてブ分析**: 専門的な議論やユーザー反応の深掘り
  * **【新】YouTube動画トレンド**: 動画コンテンツでの扱われ方分析
  * **【新】RAG統合**: 外部ナレッジベース（ユーザー指定のURL、PDF等）から関連情報を取得
* **出力**:
  * 最新トレンド情報
  * note で人気の記事構成パターン
  * SNS での訴求ポイント
  * SEO キーワード候補（プライマリ/セカンダリ/ロングテール）
  * 差別化のための独自視点
  * 【新】トピッククラスタリング（関連記事候補の提案）

#### Step 1. 検索意図・SEO分析【強化版】

* **処理**: Gemini 2.5 (Pro/Flash) + リサーチデータによる包括的分析
* **出力**:
  * 検索意図の深掘り（情報収集型/購買検討型/行動実行型の判定）
  * 上位記事構成共通点
  * 差別化要素
  * 想定FAQ（関連質問の自動生成）
  * note アルゴリズムに最適化された構成提案
  * 【新】E-E-A-T評価（経験・専門性・権威性・信頼性）の分析
  * 【新】ユーザーインテント・マッピング（検索者の心理状態分析）

#### Step 2. 記事構成案生成【強化版】

* **処理**: Step1出力＋ユーザー指定をもとにJSON構造で設計。
* **【新】複数バージョン対応**: A/Bテスト用に異なるアプローチの構成案を複数生成
* **出力構造例（JSON）**:

  ```json
  {
    "version": "A",
    "approach": "ストーリーテリング型",
    "title": "初心者でも安心！副業の始め方完全ガイド",
    "metaDescription": "未経験から副業を始めるための準備と注意点をわかりやすく解説。",
    "hook": "導入部の引きつけ要素",
    "sections": [
      {"h2": "なぜ今、副業が注目されているのか？", "summary": "...", "experienceHint": "体験談挿入箇所"},
      {"h2": "副業を始める前に決めるべき3つのこと", "summary": "..."}
    ],
    "faq": [{"q": "副業で確定申告は必要？", "a": "はい、収入が20万円を超えると必要です。"}],
    "cta": "行動喚起の提案",
    "internalLinkSuggestions": ["関連記事候補1", "関連記事候補2"],
    "seoScore": 85
  }
  ```

#### Step 3. 本文生成（Markdown出力）【強化版】

* **生成条件**:
  * **自然で人間らしい文体**: 翻訳調や機械的な表現を完全排除
  * **禁止表現の徹底**:
    * 「〜することができます」→「〜できます」or 別の自然な表現
    * 「〜について説明します」→ 直接内容に入る
    * 定型的なAI文章パターンの回避
    * 【新】「〜と言えるでしょう」「〜が重要です」等の型にはまった表現の排除
  * **共感性の重視**:
    * 少なくとも2〜3箇所に「体験談」「具体例」を挿入
    * 読者への問いかけや寄り添う表現
    * 温かみのある言葉選び
    * 【新】感情的なトーンの調整（共感/励まし/驚き等）
  * **見出し構造**: H2/H3階層で論理的に構成
  * **文字数対応**: 2,500 / 5,000 / 10,000文字に対応
  * **【新】読みやすさスコア**: 漢字率、文の長さ、接続詞のバランスを自動調整
  * **【新】引用・出典管理**: 信頼性向上のための参考文献自動挿入

#### Step 4. 画像生成（マルチモーダル対応）【強化版】

##### 4-1. アイキャッチ画像生成
* **使用技術検討中**:
  * **Google Imagen 3** (正式API待ち)
  * **代替案**: DALL-E 3、Midjourney API、Stable Diffusion
  * **フォールバック**: Unsplash/Pexels API（高品質フリー画像）
* **プロンプト例**:
  > 「ブログ執筆を楽しむ女性 フリーランス 明るい背景 pastel style 16:9」
* **【新】スタイルプリセット**: ミニマル/ビビッド/パステル/プロフェッショナル等
* **出力**: base64形式 or ダウンロードリンク

##### 4-2. 差し込み図解生成（オプション）【強化版】
* **処理**: 記事内の複雑な概念を視覚化
* **生成対象**:
  * プロセス図（フローチャート）
  * 比較表のビジュアル化
  * 統計データのグラフ
  * 概念の図解
  * 【新】タイムライン/ロードマップ
  * 【新】インフォグラフィック（統合的な情報整理）
* **【新】Mermaid.js統合**: テキストからダイアグラムを自動生成
* **マルチモーダル活用**: テキスト内容をGeminiが理解し、最適な図解を自動生成
* **挿入位置**: 記事構成に応じて最適な位置を自動判定

##### 4-3. 画像最適化【新機能】
* **自動リサイズ**: Web最適化（圧縮、フォーマット変換）
* **代替テキスト自動生成**: アクセシビリティ対応
* **画像説明文**: SEO対策のキャプション自動生成

#### Step 5. X（Twitter）告知文生成【強化版】

* **処理**: 生成した記事をSNSで訴求する短文を複数パターン生成
* **生成条件**:
  * **文字数制限**: 140文字以内（X標準）
  * **ターゲット変化**: 複数の顧客層に向けて訴求文を変える
  * **パターン出力**: 最低5パターン
  * **【新】エンゲージメント最適化**: ハッシュタグ戦略、絵文字の最適配置、投稿時間提案
  * **【新】マルチプラットフォーム対応**: X/Threads/Instagram/LinkedIn用に最適化
* **出力例**:
  ```
  【初心者向け】「副業ってどう始めればいいの？」そんな悩みを持つあなたへ。失敗しない副業の始め方を実体験をもとにまとめました📝 #副業 #初心者
  
  【経験者向け】副業で月5万円稼ぐまでにやったこと、全部書きました。これから副業を本格化させたい方は必見です💡 #副業収入 #フリーランス

  【新】【ストーリー型】3年前、副業を始めて人生が変わりました。その全プロセスを包み隠さず公開します。今日から実践できる具体的ステップとは？ #副業体験談
  ```

##### 5-1. 長文ポスト・スレッド形式展開【強化版】
* **処理**: 短文ポストを起点に、長文やスレッド形式に展開
* **展開パターン**:
  * **長文ポスト**: 記事のサマリーを300〜500文字で訴求
  * **スレッド形式**: 5〜7ツイートで記事の要点を連投形式で展開
  * **引用ポスト**: 記事の一部を引用して訴求
  * **【新】ビジュアルスレッド**: 各ツイートに対応する画像/図解を自動生成
  * **【新】投稿スケジュール提案**: 最適な投稿タイミングをデータ分析から提案

#### Step 6. 出力整形（UI表示）【強化版】

* メタ情報＋本文＋画像＋SNS告知文をカード形式で表示
* 「Copy Markdown」「Copy X Posts」ボタン
* 「note投稿手順」リンク付き
* 差し込み図解の配置プレビュー
* **【新】リアルタイムプレビュー**: note風のデザインでプレビュー表示
* **【新】SEOスコア表示**: タイトル、メタディスクリプション、キーワード密度等を評価
* **【新】読みやすさ分析**: 読了時間、難易度、文章の流れを可視化
* **【新】バージョン比較**: 複数生成時の並列表示・比較機能
* **【新】ワンクリック投稿**: note API連携で直接投稿（Phase 2）

---

## 6. 非機能要件【第2回準拠 + 2025年対応】

| 観点        | 要件                                    |
| --------- | ------------------------------------- |
| UI/UX     | 生成中のステップ表示・進捗バー（7段階表示）。レスポンシブ対応。各ステップの処理内容を可視化。**【新】ダークモード対応**、**キーボードショートカット**、**ドラフト自動保存**。 |
| パフォーマンス   | 記事生成は60秒以内（5000文字基準）、90秒以内（10000文字基準）。リサーチAPIは並列処理で高速化。**【新】モデル選択による速度調整（Flash=30秒、Pro=60秒）**。**【新】段階的レンダリング**（生成途中の表示）。 |
| セキュリティ    | APIキーはサーバー側で保持。ユーザー環境に保存しない。外部API連携時の認証管理。メモリ機能（Phase 2）ではユーザーデータの暗号化と適切なアクセス制御。**【新】GDPR/個人情報保護法対応**。**【新】コンテンツフィルタリング**（不適切表現の自動検出）。 |
| エラーハンドリング | Gemini呼び出し失敗時にリトライ＆エラーメッセージ表示。外部API接続エラー時の代替処理。**【新】グレースフルデグラデーション**（機能段階的縮退）。**【新】ユーザーフレンドリーなエラーメッセージ**。 |
| 拡張性       | note投稿API、外部CMS連携、スケジュール投稿機能に対応可能な設計。モジュール化されたリサーチ機能で新規データソース追加が容易。メモリ機能の段階的実装に対応。**【新】プラグインアーキテクチャ**（サードパーティ拡張）。 |
| API管理     | Google Search API、note API（将来）、X API（将来）の統合管理。レート制限への対応。**【新】APIキャッシング**（コスト削減）。**【新】フォールバック戦略**（API障害時の代替手段）。 |
| データ管理（Phase 2） | Supabaseによる永続化。ユーザープロファイル、投稿履歴、学習データの適切な管理。GDPR準拠のデータ削除機能。**【新】ベクトルデータベース統合**（RAG対応）。**【新】バックアップ・リストア機能**。 |
| アクセシビリティ【新】 | WCAG 2.1 AA準拠。スクリーンリーダー対応。キーボードナビゲーション。代替テキスト自動生成。 |
| 国際化【新】 | 多言語UI対応（日本語/英語）。将来的に記事生成も多言語対応。 |

---

## 7. 今後の発展ロードマップ【第3・4回と連動 + 2025年新規】

| フェーズ    | 内容                         | 担当ツール            | 主な機能 | 実装状況 |
| ------- | -------------------------- | ---------------- | --- | --- |
| **Phase 1** ✅ | note記事生成エージェントβ版 | React + TypeScript + Vite | 統合リサーチ、記事生成、X告知文生成（短文/長文）、モデル選択 | **100%完了** |
| **Phase 1.5** ⚡ | UX強化・品質向上 | Next.js 15完全移行済み | **ファクトチェック（Tavily）**、**SEOキーワードセット生成**、ダークモード、リアルタイムプレビュー、音声入力、複数バージョン生成 | **90%完了** |
| **Phase 2** 🚀 | 自動投稿＋外部連携＋メモリ | Supabase + Playwright | **note自動投稿（Playwright）**、**複数記事並行生成**、**最新ニュース記事生成**、**Human-in-the-Loop設計**、X API連携、メモリ機能、**RAG統合** | **基盤準備完了** |
| **Phase 2.5** 👥 | コラボレーション機能 | Supabase Realtime + WebSocket | リアルタイム共同編集、コメント機能、バージョン管理、チーム管理、承認ワークフロー | **基盤準備完了** |
| **Phase 3** 📊 | コンテンツ拡張＋分析 | Analytics + 外部API | **スライド生成**、**WordPress自動投稿**、**キャンペーン・商材管理**、分析ダッシュボード、A/Bテスト、**月間生成数管理** | **計画段階** |
| **Phase 3.5** 🏢 | エンタープライズ機能 | Enterprise Stack | 複数ブランド管理、高度な承認ワークフロー、監査ログ、SSO、代理店契約システム | **計画段階** |
| **Phase 4** 🌐 | マルチプラットフォーム | Vercel + Cron + GitHub Actions | X/Threads/Instagram/LinkedIn同時投稿、予約投稿、**GitHub Actions統合**、Zapier/Make連携 | **計画段階** |
| **Phase 5** 🤖 | AI自律エージェント化 | LangChain + AutoGPT | トレンド自動検知→記事生成→投稿→効果測定の完全自動化、セルフラーニング、エージェント間協調 | **計画段階** |

---

## 8. 参考リンク・競合分析（2025年10月更新）

### 競合ツール詳細分析

詳細な競合分析は **[Competitive-analysis.md](./Competitive-analysis.md)** を参照。

#### 主要競合

1. **tsumugi**（https://www.tsumugi-ai.com/）
   - **特徴**: SEO最適化記事自動生成・投稿、Claude 3.7 Sonnet活用
   - **価格**: ¥240,000〜560,000/年（月間200〜500記事）
   - **強み**: noteとWordPress自動投稿、スライド生成、企業向け機能充実
   - **弱み**: 高価格、SNS展開機能なし、A/Bテストなし
   - **実績**: リリース3時間でARR1億円突破

2. **GitHub Actions + Playwright実装**（個人開発者）
   - **特徴**: オープンソース的DIY実装、ファクトチェック統合
   - **価格**: 無料（GitHub Actions無料枠）
   - **強み**: 低コスト、Human-in-the-Loop設計
   - **弱み**: エンジニア向け、UIなし、SEO分析弱い

3. **Jasper / Copy.ai**
   - **特徴**: 英語圏汎用AIライティング
   - **価格**: $39〜125/月
   - **弱み**: 日本語品質、note特化なし

4. **Notion AI**
   - **特徴**: エディタ統合型
   - **価格**: $10/月
   - **弱み**: note特化なし、SNS展開なし

5. **Gamma**
   - **特徴**: プレゼン/ドキュメント自動生成

### 本ツールの差別化ポイント（競合比較版）

| 観点 | Note Agent AI | tsumugi | GitHub実装 | Jasper |
|------|---------------|---------|-----------|--------|
| **価格** | ✅ **無料（Phase 1）** | ❌ 年24〜56万円 | ✅ 無料 | ❌ 月$39〜 |
| **対象ユーザー** | ✅ **個人〜企業まで** | 企業向け | エンジニア向け | 英語圏企業 |
| **統合リサーチ** | ✅ **Google/note/SNS/RAG** | △ 基本的 | △ Web検索のみ | ❌ なし |
| **SNS展開** | ✅ **X投稿生成（短文/長文/スレッド）＋エンゲージメント予測** | ❌ なし | ❌ なし | ❌ なし |
| **ファクトチェック** | ✅ **Tavily統合（Phase 1.5）** | ❓ 不明 | ✅ あり | ❌ なし |
| **A/Bテスト** | ✅ **複数バージョン生成** | ❌ なし | ❌ なし | ❌ なし |
| **note自動投稿** | ✅ **Playwright（Phase 2）** | ✅ あり | ✅ あり | ❌ なし |
| **Human-in-the-Loop** | ✅ **承認フロー（Phase 2）** | ❓ 不明 | ✅ あり | ❌ なし |
| **日本語品質** | ✅ **Gemini 2.5** | ✅ Claude 3.7 | ✅ Claude 4.5 | △ 英語優先 |
| **コラボレーション** | ✅ **リアルタイム共同編集（Phase 2.5）** | ❌ なし | ❌ なし | △ 限定的 |

### 独自の強み（競合が真似できない）

1. **🆓 無料で高機能**: Phase 1完全無料 → 個人クリエイターに最適
2. **🐦 SNS統合**: X投稿（短文/長文/スレッド）＋エンゲージメント予測
3. **✍️ 自然な文章**: AIっぽさ徹底排除、体験談挿入、共感性重視
4. **🔬 統合リサーチ**: Google + note + SNS + RAG
5. **🎨 マルチモーダル**: 図解自動生成（Mermaid.js）
6. **🔄 A/Bテスト**: 複数バージョン生成で最適化
7. **👥 コラボレーション**: リアルタイム共同編集
8. **🤖 自律エージェント**: トレンド検知から投稿まで完全自動化（Phase 5）
9. **🔐 Human-in-the-Loop**: 承認フロー・品質管理
10. **📊 ファクトチェック**: Tavily統合で事実確認

### 競合から学ぶ追加機能

#### tsumugiから採用
- ✅ note自動投稿（Playwright）
- ✅ 複数記事並行生成
- ✅ スライド生成機能
- ✅ WordPress自動投稿
- ✅ キャンペーン・商材管理
- ✅ SEOキーワードセット生成
- ✅ 最新ニュースから記事生成

#### GitHub実装から採用
- ✅ GitHub Actions統合
- ✅ ファクトチェック（Tavily）
- ✅ Human-in-the-Loop設計
- ✅ 下書き保存機能

---

## 9. 開発環境・使用技術（詳細設計要素）

| 項目         | 内容                        |
| ---------- | ------------------------- |
| フロントエンド | React + TypeScript + Vite → **【Phase 1.5】Next.js 14 (App Router)** |
| AIモデル     | **Gemini 2.5 Flash**（高速） / **Gemini 2.5 Pro**（高品質） |
| 画像生成     | 検討中（Imagen 3待ち / DALL-E 3 / Stable Diffusion / Unsplash API） |
| 外部API連携 | Google Search API / note API（予定） / X API（予定） / **YouTube Data API** / **Reddit API** |
| リサーチ機能 | マルチソース統合リサーチ（検索API、SNS API、Webスクレイピング）+ **RAG（LangChain）** |
| ストレージ      | ローカルストレージ（Phase 1） → **Supabase + Pgvector**（Phase 2以降）   |
| データ形式      | Markdown / JSON / base64（画像） / **Mermaid（図解）**           |
| デプロイ    | ローカル開発 → **Vercel / Cloudflare Pages**（Phase 2以降） |
| バージョン管理 | Git + GitHub（記事生成履歴も管理） |
| 認証【新】 | **Supabase Auth**（Phase 2以降） |
| リアルタイム通信【新】 | **Supabase Realtime / WebSocket**（Phase 2.5以降） |

---

## 10. 出力サンプル（統合ワークフロー形式）

```json
{
  "input": {
    "keyword": "AIライティング 効率化",
    "tone": "丁寧",
    "audience": "初心者",
    "length": 5000,
    "imageOptions": {
      "eyecatch": true,
      "inlineGraphics": true
    },
    "versions": 3,
    "model": "gemini-2.5-flash",
    "ragEnabled": false
  },
  "workflow": [
    {
      "step": 0,
      "name": "integrated_research",
      "description": "統合リサーチ機能",
      "apis": ["Google Search API", "note Platform Analysis", "SNS Trend Analysis", "Reddit API"],
      "duration": "10s"
    },
    {
      "step": 1,
      "name": "seo_analysis",
      "description": "検索意図・SEO分析",
      "duration": "5s"
    },
    {
      "step": 2,
      "name": "outline_generation",
      "description": "記事構成案生成（3バージョン）",
      "duration": "8s"
    },
    {
      "step": 3,
      "name": "article_generation",
      "description": "本文生成（AI表現排除、共感性重視）",
      "duration": "25s"
    },
    {
      "step": 4,
      "name": "image_generation",
      "description": "画像生成（アイキャッチ + 差し込み図解）",
      "model": "Unsplash API (fallback)",
      "duration": "5s"
    },
    {
      "step": 5,
      "name": "x_post_generation",
      "description": "X告知文生成（複数パターン + スレッド展開）",
      "duration": "7s"
    },
    {
      "step": 6,
      "name": "final_output",
      "description": "出力整形・UI表示",
      "duration": "2s"
    }
  ],
  "output": {
    "versions": [
      {
        "id": "A",
        "approach": "ストーリーテリング型",
        "article": {
          "title": "...",
          "metaDescription": "...",
          "content": "...",
          "wordCount": 5000,
          "readingTime": "約8分",
          "readabilityScore": 82,
          "seoScore": 85
        }
      },
      {
        "id": "B",
        "approach": "ハウツー型",
        "article": {
          "title": "...",
          "metaDescription": "...",
          "content": "...",
          "wordCount": 4800,
          "readingTime": "約7分",
          "readabilityScore": 88,
          "seoScore": 83
        }
      },
      {
        "id": "C",
        "approach": "データドリブン型",
        "article": {
          "title": "...",
          "metaDescription": "...",
          "content": "...",
          "wordCount": 5200,
          "readingTime": "約9分",
          "readabilityScore": 75,
          "seoScore": 90
        }
      }
    ],
    "images": {
      "eyecatch": "base64_data",
      "inlineGraphics": ["base64_data_1", "base64_data_2"],
      "altTexts": ["代替テキスト1", "代替テキスト2"]
    },
    "socialMedia": {
      "xPosts": [
        {
          "target": "初心者",
          "text": "...",
          "hashtags": ["#AIライティング", "#初心者"],
          "estimatedEngagement": "high"
        },
        {
          "target": "経験者",
          "text": "...",
          "hashtags": ["#効率化", "#生産性"],
          "estimatedEngagement": "medium"
        }
      ],
      "threads": [
        ["tweet1", "tweet2", "tweet3"]
      ],
      "scheduleSuggestion": "2025-10-16 19:00 (火曜夕方・エンゲージメント率高)"
    },
    "research": {
      "trends": "...",
      "seoKeywords": {
        "primary": ["AIライティング", "効率化"],
        "secondary": ["自動生成", "時短"],
        "longTail": ["AIライティング 初心者 おすすめ"]
      },
      "notePopularPatterns": "..."
    },
    "analytics": {
      "estimatedReadTime": "8分",
      "difficultyLevel": "初級",
      "emotionalTone": "励まし/共感",
      "recommendedVersion": "B (読みやすさと SEO のバランス最適)"
    }
  }
}
```

---

## 11. 主要機能の優先順位

### Phase 1（MVP）で実装する機能

1. ✅ **統合リサーチ機能**（主力機能）
2. ✅ SEO分析・記事構成生成
3. ✅ 本文生成（AIっぽくないライティング）
4. ✅ アイキャッチ画像生成（Unsplash API / フリー画像）
5. ✅ X告知文生成（基本パターン）
6. ✅ モデル選択（Flash / Pro）

### Phase 1.5（実装状況）完了率: 90%

#### ✅ **完全実装済み**
7. ✅ **複数バージョン生成（A/Bテスト）** - 完全実装済み
8. ✅ **ダークモード** - 完全実装済み
9. ✅ **リアルタイムプレビュー** - 完全実装済み
10. ✅ **音声入力対応** - 完全実装済み

#### 🚧 **基盤完成・UI統合待ち**
11. 🚧 差し込み図解生成（Mermaid.js） - DiagramService完成、UI統合待ち
12. 🚧 **読みやすさ/SEOスコア表示** - 計算ロジック完成、UI統合待ち

#### ⚪ **残り作業**
13. ⚪ スレッド形式展開 - 30%完了
14. ⚪ 10,000文字対応 - 95%完了（フォーム対応済み）

### Phase 2以降で実装する機能

15. 🔲 note自動投稿API連携
16. 🔲 X自動投稿API連携
17. 🔲 記事履歴データベース化（Supabase）
18. 🔲 効果測定・分析機能
19. 🔲 **メモリ機能**（投稿スタイル記憶・パーソナライズ）
20. 🔲 **RAG統合**（外部ナレッジベース参照）
21. 🔲 **ユーザー認証**
22. 🔲 **リアルタイムコラボレーション**

---

## 12. メモリ機能（Phase 2以降の実装）

### 12.1 機能概要

ユーザーの投稿スタイルや過去の投稿内容を記憶し、一貫性のあるパーソナライズされた記事生成を実現する機能。データベース（Supabase）やベクトルストレージ（Pgvector）と連携して、長期的な学習とブランディングの維持を支援。

### 12.2 記憶する情報

#### ユーザープロファイル
- **基本設定**: よく使うトーン、ターゲット読者層、文字数の傾向
- **文体の特徴**: 
  - 語尾の癖（です・ます調 vs だ・である調）
  - よく使う接続詞や表現
  - 一人称の使い方（私、僕、筆者など）
  - 絵文字の使用頻度と傾向
- **専門分野**: よく扱うテーマ・ジャンル
- **NGワード/NGトピック**: 避けるべき表現や話題

#### 投稿履歴
- **過去の記事データ**:
  - タイトルパターン
  - 見出し構造の傾向
  - よく使うキーワード
  - 画像スタイルの好み
- **パフォーマンスデータ**:
  - スキ数、閲覧数、コメント数
  - 反響の良かった記事の特徴分析
  - 曜日・時間帯別の投稿実績

#### ブランドガイドライン
- **ビジュアルアイデンティティ**: 
  - カラーパレット
  - 画像のトーン＆マナー
  - ロゴ・透かしの配置
- **メッセージング**: 
  - コアメッセージ
  - 価値観・ミッション
  - ターゲットペルソナの詳細

### 12.3 メモリ機能の活用シーン

1. **初回設定後の自動最適化**
   - 2〜3記事生成後、自動的にスタイルを学習
   - 「あなたらしい」文章表現を提案

2. **ブランド一貫性の維持**
   - 複数人で運用する企業アカウントでも、統一された文体を維持
   - トーン＆マナーガイドラインに自動適合

3. **過去記事との重複回避**
   - 同じテーマで記事生成時、過去記事との差別化を自動提案
   - 「以前書いた〇〇記事」として内部リンク候補を提示

4. **成功パターンの再現**
   - 反響の良かった記事の構成・表現を分析
   - 次回記事生成時に成功要素を取り入れる

5. **進化する文体**
   - ユーザーの編集・加筆内容から学習
   - 自然にスタイルが進化・洗練される

### 12.4 技術実装（Phase 2）

#### データストレージ
- **Supabase**: ユーザープロファイル、投稿履歴、設定情報
- **PostgreSQL + Pgvector**: 構造化データの保存、ベクトル検索
- **Vector Database**: 文体の埋め込み表現を保存し、類似性検索

#### メモリ管理
```typescript
interface UserMemory {
  userId: string;
  profile: {
    preferredTone: string;
    targetAudience: string;
    writingStyle: {
      sentenceEndings: string[];
      commonPhrases: string[];
      firstPersonPronoun: string;
      emojiFrequency: 'none' | 'low' | 'medium' | 'high';
    };
    ngWords: string[];
    specialties: string[];
  };
  history: {
    articles: Article[];
    performance: ArticlePerformance[];
    successPatterns: string[];
  };
  brandGuidelines?: {
    visualIdentity: VisualStyle;
    messaging: CoreMessage;
  };
  lastUpdated: Date;
}
```

#### 学習・適用フロー
1. **投稿後のフィードバック収集**
   - ユーザーの編集内容を分析
   - 「この表現が好き」「この構成が良い」を学習

2. **次回生成時の適用**
   - メモリデータをプロンプトに注入
   - 「以下のスタイルで記事を生成してください」として指示

3. **定期的な再学習**
   - 週次・月次でスタイルの傾向を再分析
   - ユーザーの成長・変化に対応

### 12.5 ユーザー設定UI（Phase 2）

- **メモリ管理画面**: 学習した内容の確認・編集
- **スタイルプレビュー**: 「あなたのスタイル」を可視化
- **リセット機能**: スタイル学習をやり直す
- **インポート/エクスポート**: 設定の移行・バックアップ

---

## 13. 新機能詳細【2025年10月追加】

### 13.1 RAG（Retrieval-Augmented Generation）統合

**概要**: 外部知識ベースを参照しながら記事を生成する機能。

**ユースケース**:
- 企業の製品ドキュメントやFAQを参照しながら記事生成
- 専門書籍のPDFを読み込んで専門的な記事を作成
- 過去の自分の記事を参照して一貫性のある続編を作成

**技術実装**:
- **LangChain**: RAGパイプラインの構築
- **Pgvector**: ベクトル検索用ストレージ
- **Embeddings**: Gemini Embedding APIで文書をベクトル化

### 13.2 音声入力対応

**概要**: スマホやPCのマイクから音声で記事のアイデアを入力。

**ユースケース**:
- 移動中にアイデアを録音して記事化
- インタビュー音声から記事を自動生成
- 音声メモをnote記事に変換

**技術実装**:
- **Web Speech API**: ブラウザネイティブの音声認識
- **Gemini Audio**: 音声ファイルの高精度文字起こし

### 13.3 複数バージョン生成（A/Bテスト）

**概要**: 同じテーマで異なるアプローチの記事を3〜5パターン生成。

**生成バージョン例**:
- **ストーリーテリング型**: 体験談中心
- **ハウツー型**: 手順・ステップ重視
- **データドリブン型**: 統計・事実重視
- **Q&A型**: 質問形式で展開
- **リスト型**: 箇条書き・リスト構成

**メリット**:
- 最も反響の良いスタイルを選択可能
- ターゲット層に応じて使い分け
- 記事の多様性を確保

### 13.4 リアルタイムコラボレーション（Phase 2.5）

**概要**: 複数人で同時に記事を編集・レビュー。

**機能**:
- **リアルタイム共同編集**: Google Docs風の同時編集
- **コメント機能**: 特定箇所にコメント・提案
- **役割分担**: リサーチャー/ライター/編集者/デザイナー
- **変更履歴**: 誰がいつ何を変更したか追跡
- **承認ワークフロー**: 記事公開前の承認プロセス

**技術実装**:
- **Supabase Realtime**: WebSocket通信
- **CRDT (Conflict-free Replicated Data Type)**: 同時編集の競合解決
- **Y.js**: 共同編集ライブラリ

### 13.5 自律型AIエージェント（Phase 5）

**概要**: 完全自動でトレンド検知→記事生成→投稿→効果測定を実行。

**動作フロー**:
1. **トレンド自動検知**: 毎日SNS/検索トレンドをスキャン
2. **記事テーマ提案**: ユーザーに「このテーマで書きませんか？」と提案
3. **自動生成**: 承認後、自動で記事生成
4. **最適投稿**: 最適なタイミングで自動投稿
5. **効果測定**: スキ数/閲覧数を追跡し、次回記事に反映
6. **セルフラーニング**: 成功パターンを学習し、精度向上

**技術実装**:
- **LangChain Agents**: エージェント動作の制御
- **AutoGPT**: 自律型タスク実行
- **Cron Jobs**: 定期実行スケジューリング

---

## 14. 技術的課題と解決策

| 課題 | 解決策 |
|-----|-------|
| **画像生成APIの不確実性** | Imagen 3待ち。代替としてDALL-E 3 / Stable Diffusion / Unsplash APIを並行検討。フォールバック戦略の実装。 |
| **APIコスト管理** | キャッシング機構の実装。Flashモデルの積極活用。ユーザー単位のクォータ管理。 |
| **レート制限対策** | リトライロジック、指数バックオフ、リクエストキューイング、複数APIキーのローテーション。 |
| **大量テキスト処理のパフォーマンス** | 段階的レンダリング、ストリーミングレスポンス、Web Workers活用。 |
| **日本語特有の表現最適化** | プロンプトエンジニアリングの継続改善。ユーザーフィードバックの収集と反映。 |
| **セキュリティ（APIキー保護）** | サーバーサイドでの処理、環境変数管理、ユーザー認証の実装。 |

---

この要件定義書をもとに、**React + TypeScript + Vite**（Phase 1）、**Next.js 14**（Phase 1.5以降）での実装を進めます。

---

**更新履歴**:
- **2025年10月15日（第2版）**: 競合分析を追加（tsumugi、GitHub Actions実装）。Phase 1.5〜4に追加機能を反映（ファクトチェック、note自動投稿、スライド生成、WordPress投稿、キャンペーン管理等）。差別化ポイントを強化。
- 2025年10月15日（第1版）: 2025年版にアップデート。新機能（RAG、音声入力、A/Bテスト、コラボレーション、自律エージェント）を追加。技術スタックの最新化。
